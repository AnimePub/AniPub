<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Anime Player - A Free Anime Watching Site built by Anime Loves for Anime Lovers">
    <meta name="description" content="<%=video.DescripTion %> ">
    <meta name="keywords" content="<%= video.Genres %> ">
    <title>AniPub | <%=video.Name %> </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" />
    <link rel="stylesheet" href="/first-section.css">
    <link rel="stylesheet" href="/third-section.css">
    <link rel="stylesheet" href="/info-container.css">
    <link rel="stylesheet" href="/media2-styles.css">
    <link rel="stylesheet" href="/media2-styles.css">
    <link rel="stylesheet" href="/JPlayer.css">

    <link rel="stylesheet" href="/media-styles.css">
    <link rel="stylesheet" href="/videoPlayerHeader.css">
    <link rel="stylesheet" href="/body-scrollbar.css">


</head>

<body>

    <!-- Header -->
    <%- include("./include/aniHeader") %>
    <!-- Notify -->
    <div class="toast" id="save-toast">
        <i class="fas fa-check-circle"></i>
        <span class="notify-span">Info Saved</span>
    </div>
    <div class="container">
        <div>
            <div class="main-content">
                <div class="main-column">
                    <!-- Video Player Section -->
                    <section class="video-section">
                        <div class="video-container">
                            <% if(video.type === "iframe") {%>
                            <% if(Number(AniEP) === 0 ) {%>
                            <iframe <%=video.link%> sandbox="allow-same-origin allow-scripts" gyroscope picture-in-picture autoplay scrolling="no" frameborder="1" marginheight="0px" marginwidth="0px" allowfullscreen geolocation style="height:100%;width: 100%;"></iframe>
                            <% } else { %>
                            <% const Episode = Number(AniEP) - 1 %>
                            <iframe <%=video.ep[Episode].link%> sandbox="allow-same-origin allow-scripts" gyroscope picture-in-picture autoplay geolocation scrolling="no" frameborder="1" marginheight="0px" marginwidth="0px" allowfullscreen style="height:100%;width: 100%;"></iframe>
                            <%}%>
                            <% } else {%>
                            <video id="my-video" class="video-js vjs-matrix video-player " controls autoplay preload="auto" data-setup="{}">
                                <% if(video.type === "mp4") {%>
                                <% if(Number(AniEP) === 0 ) {%>
                                <source src="/<%=video.link%>" type="video/mp4">
                                <% } else { %>
                                <% const Episode = Number(AniEP) - 1 %>
                                <source src="/<%=video.ep[Episode].link%>" type="video/mp4">
                                <% } %>

                                <% } else { %>
                                <% if(Number(AniEP) === 0 ) {%>
                                <source src="<%=video.link%>" type="video/mp4">
                                <% } else {%>
                                <% const Episode = Number(AniEP) - 1 %>
                                <source src="<%=video.ep[Episode].link%>" type="video/mp4">
                                <% } %>
                                <% } %>
                            </video>
                            <% } %>
                        </div>

                        <div class="video-info">
                            <h1 class="video-title"><%=video.Name %></h1>
                            <div class="video-meta">
                                <span>Episode <%= Number(AniEP) + 1 %></span>
                                <span><i class="fas fa-star"></i> <%=video.MALScore %></span>
                                <span><i class="fas fa-clock"></i> <%=video.Duration %></span>
                            </div>

                            <div class="video-actions">
                                <button class="btn btn-primary left-btn">
                                    <i class="fas fa-arrow-left"></i> Previous Episode
                                </button>
                                <button class="btn btn-primary right-btn">
                                    Next Episode <i class="fas fa-arrow-right"></i>
                                </button>
                                <button class="btn btn-secondary">
                                    <i class="fas fa-download"></i> Download
                                </button>
                                <button class="btn btn-secondary share-btn">
                                    <i class="fas fa-share-alt"></i> Share
                                </button>
                                <button class="Watchlist-btn Add-to-watchlist-button" data-animelink="https://animehub.adnandluffy.site/AniPlayer/<%=AniId%>/<%=AniEP%>">
                                    Add To Watchlist
                                </button>
                            </div>
                        </div>
                    </section>

                    <section class="episodes-section">
                        <h2 class="section-title"><i class="fas fa-list"></i> Episodes</h2>
                        <div class="episodes-grid">
                            <div class="episode-card <%= Number(AniEP) === 0 ? 'active' : '' %>" data-ep="0" data-anime="<%=Number(AniId)+1%>">
                                <% const IMAGE2 = video.ImagePath;
                            const IAGE2 = IMAGE2.split("https://");
                            %>
                                <div class="episode-info">
                                    <div class="episode-number">Episode 1</div>
                                    <div class="episode-name"><%= video.name %></div>
                                </div>
                            </div>
                            <% if (video.ep.length >0){ %>
                            <% video.ep.forEach((value,i) => { %>
                            <div class="episode-card <%= Number(AniEP) === (i + 1) ? 'active' : '' %>" data-ep="<%=i+1%>" data-anime="<%=Number(AniId)+1%>">
                                <% const IMAGE3 = video.ImagePath;
                                    const IAGE3 = IMAGE3.split("https://");
                                    %>

                                <div class="episode-info">
                                    <div class="episode-number">Episode <%= i+2 %></div>
                                    <div class="episode-name">
                                        <% if(video.ep[i].name) {%>
                                        <%= video.ep[i].name%>
                                        <% } else { %>
                                        Episode No.<%= i+2 %>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                            <% }); %>
                            <% }; %>
                        </div>
                    </section>


                </div>

                <!-- Sidebar with Anime Info -->
                <div class="sidebar-column">
                    <div class="anime-info-sidebar">

                        <!-- Anime Details -->
                        <div class="anime-details">
                            <h2 class="section-title"><i class="fas fa-info-circle"></i> Details</h2>

                            <div class="detail-item">
                                <span class="detail-label">Synonyms:</span>
                                <span class="detail-value"><%=video.Synonyms %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Aired:</span>
                                <span class="detail-value"><%=video.Aired %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Premiered:</span>
                                <span class="detail-value"><%=video.Premiered %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Duration:</span>
                                <span class="detail-value"><%=video.Duration %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Status:</span>
                                <span class="detail-value"><%=video.Status %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">MAL Score:</span>
                                <span class="detail-value"><%=video.MALScore %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Studios:</span>
                                <span class="detail-value"><%=video.Studios %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Producers:</span>
                                <span class="detail-value"><%=video.Producers %></span>
                            </div>

                            <div class="detail-item">
                                <span class="detail-label">Genres:</span>
                                <span class="detail-value">
                                    <div class="genre-list">
                                        <% 
                // Normalize genres to always be an array
                const genresArray = Array.isArray(video.Genres) 
                    ? video.Genres 
                    : (video.Genres ? video.Genres.split(',').map(g => g.trim()) : []); 
            %>
                                        <% genresArray.forEach(genre => { %>
                                        <a href="/Search?genre=<%=genre%>"><span class="genre-tag genre" data-genre="<%=genre%>"><%=genre%></span></a>

                                        <% }); %>
                                    </div>
                                </span>
                            </div>


                            <div class="divider"></div>

                            <!-- Description -->
                            <h2 class="section-title"><i class="fas fa-file-alt"></i> Synopsis</h2>
                            <p class="description">
                                <%=video.DescripTion %>
                            </p>
                        </div>


                    </div>






                </div>


            </div>



            <div class="recommendations-section">
                <h2 class="section-title"><i class="fas fa-fire"></i> Recommendations</h2>
                <div class="recommendations-grid">
                    <% if (AniDB.length > 0) { %>
                    <% AniDB.forEach((value, i) => { %>
                    <div class="anime-card" data-anime="<%=value._id%>">
                        <img class="anime-thumb" src="/<%= value.poster %>" alt="<%= value.Name %>">
                        <div class="anime-card-info">
                            <h3 class="anime-card-title"><%= value.Name %></h3>
                            <div style="display: flex; align-items: center; justify-content: right;"> <span style="font-size: 10px;"><%= value.ep.length +1 %> Episodes</span></div>
                            <div class="anime-card-meta">
                                <span><%=value.MALScore %></span>

                                <span>
                                    <img class="ratings-image" src="/rating-<%=value.RatingsNum%>.png" alt="">
                                </span>
                            </div>
                        </div>
                    </div>
                    <% }); %>
                    <% } %>
                </div>
            </div>

            <!-- Comments Section -->
            <section class="comments-section">
                <h2 class="section-title"><i class="fas fa-comments"></i> Comments</h2>
                <div id="disqus_thread" style="margin-top: 60px;"></div>
            </section>



        </div>
    </div>
    <div class="modal-container">
        <div class="Box-modal">
            <div>
                <p class="anamemodal">Name: <span><%=video.Name%></span></p>
            </div>
            <div>
                <p class="epno">Ep No. <%=AniEP+1%></p>
            </div>
            <div class="link-constainer">
                <p style="white-space: wrap;">https://animehub.adnandluffy.site/AniPlayer/<%=AniId+1%>/<%=AniEP%></p>
            </div>
            <div class="share-media-div">
                <p class="sn">Share Now:-</p>
                <div class="options-div">
                    <div class="opt-div">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://animehub.adnandluffy.site/AniPlayer/<%=AniId+1%>/<%=AniEP%>&quote=Hello,%20this%20%20awesome%20episode%20 target=" _blank">
                            <button class="shared-button-m">
                                <img src="/fb.svg" alt="">
                            </button>
                        </a>

                        <p class="b-title">Facebook</p>
                    </div>

                    <div class="opt-div">
                        <a href="https://api.whatsapp.com/send?text=Hello,%20this%20awesome%20episode%20..%20https://animepub.adnandluffy.site/AniPlayer/<%=AniId%>/<%=AniEP%>" target="_blank">
                            <button class="shared-button-m">
                                <img src="/WhatsApp.svg" alt="">
                            </button>
                        </a>

                        <p class="b-title">WhatsApp</p>
                    </div>

                    <div class="opt-div">
                        <a href="https://t.me/share/url?url=https://animehub.adnandluffy.site/AniPlayer/<%=AniId+1%>/<%=AniEP%>&text=Hello,%20this%20awesome%20episode%20.." target="_blank">
                            <button class="shared-button-m">
                                <img src="/telegram.svg" alt="">
                            </button>
                        </a>

                        <p class="b-title">Telegram</p>
                    </div>

                </div>
            </div>
            <p class="last-msge">All videos on this site are hosted on third
                party website so
                there may be some bugs or broken links.. and you can also report it to us
                here's our contact info:-
            </p>
            <div class="button-container-modal">
                <a target="_blank" href="https://github.com/Animepub/"><button class="Git-buttonM">
                        <img class="git-im" src="/github.svg" alt="">
                        Githhub
                    </button></a>
                <a target="_blank" href="https://www.facebook.com/adnandluffy.atomic"> <button class="fb-bM">
                        <img class="f-p" src="/fb.svg" alt="">Facebook
                    </button> </a>
            </div>

            <div class="wmdiv">
                <p class="Wm">Do you want to leave this ?</p>
            </div>

            <div class="lbm"><button class="leave">Yes</button><button class="stay">No</button></div>
        </div>
    </div>

    <%- include("./include/footer") %>





    <script>
        var disqus_config = function() {
            this.page.url = window.location.href;
            this.page.identifier = window.location.pathname;
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document,
                s = d.createElement('script');
            s.src = 'https://anipub.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    <script id="dsq-count-scr" src="//anipub.disqus.com/count.js" async></script>
    <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script>
    <script src="/videoPlay.js"></script>
    <script src="/Changer-AniPlayer.js"></script>
    <script src="/dialog.js"></script>
    <script src="/upDate-playlist.js"></script>
    <script src="/home.js"></script>
    <script src="/playList-Up.js"></script>
    <script src="/ANiPlayer-render.js"></script>
    <script src="/play.js"> </script>
    <script>
        if (window.location.protocol === "http:") {
            const NEWL = document.querySelectorAll(".poster,.episode-thumb,.anime-poster,.anime-thumb");
            NEWL.forEach(value => {
                const SRC = value.src;
                const hiluR = SRC.split("https://");
                if (hiluR.length === 2) {
                    const SEC = hiluR[1];
                    const ILU = `https://` + SEC;
                    value.src = ILU;
                }
            });
        } else {
            const NEWLS = document.querySelectorAll(".poster,.episode-thumb,.anime-poster,.anime-thumb");
            NEWLS.forEach(value => {
                const SRC = value.src;
                const hiluR = SRC.split("https://");
                if (hiluR.length >= 3) {
                    const SEC = hiluR[2];
                    const ILU = `https://` + SEC;
                    value.src = ILU;
                }
            });
        }
    </script>
</body>

</html>